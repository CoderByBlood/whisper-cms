@startuml
|RequestManager|
start
:State = Booting;
note right
ğŸŸ¡ Booting Phase
end note

label CheckConfig
:Ask StartupManager: does configuration exist?;

|StartupManager|
if (Configuration exists?) then (No)
  -> ConfigFlow : No;
else (Yes)
  :Load configuration;
  :Validate configuration;

  if (Configuration valid?) then (No)
    -> ConfigFlow : No;
  else (Yes)
    :Get database connection;
    :Test database connection;

    if (DB connection success?) then (No)
      -> ConfigFlow : No;
    else (Yes)
      :Go to "âš™ï¸ Validate Settings";
      stop;
    endif
  endif
endif

' ---------- Configuration Flow ----------
|RequestManager|
label ConfigFlow
:Change phase to Configuring;
note right
ğŸ”§ Configuring Phase
end note
:Bind to socket;
:Serve configuration screen to Admin;

|Admin|
:Login;
:Submit configuration to StartupManager;

|RequestManager|
-> CheckConfig;

' ---------- Settings Validation ----------
|StartupManager|
label ValidateSettings
:Ask SettingsManager for settings;
note right
âš™ï¸ Validate Settings
end note

|SettingsManager|
:Validate settings;

if (Settings valid?) then (No)
  -> InstallFlow : No;
else (Yes)
  :Go to "âœ… Serving Phase";
  stop;
endif

' ---------- Installation Flow ----------
|RequestManager|
label InstallFlow
:Change phase to Installing;
note right
ğŸ§© Installing Phase
end note
:Bind to socket;
:Serve installation screen to Admin;

|Admin|
:Login;
:Submit installation settings to SettingsManager;

|SettingsManager|
:Save settings;
:Go to "âš™ï¸ Validate Settings";
stop;

' ---------- Serving State ----------
|RequestManager|
label ServeFlow
start;
note right
<Settings valid?>
Yes <--+
end note
:Change phase to Serving;
note right
âœ… Serving Phase
end note
:Bind to socket;
:Serve content to Clients;

|Clients|
stop
@enduml